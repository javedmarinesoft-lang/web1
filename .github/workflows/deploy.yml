- name: Deploy Next.js App
  run: |
    ssh ${{ secrets.SERVER_USER }}@${{ secrets.SERVER_HOST }} << 'EOF'
    set -e
    cd ${{ secrets.APP_PATH }}

    if [ ! -d ".git" ]; then
      git clone https://github.com/javedmarinesoft-lang/web1.git .
    else
      git pull origin main
    fi

    npm install
    npm run build

    pm2 restart nextjs-app || pm2 start npm --name "nextjs-app" -- start
    pm2 save
    EOF
